<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <title>Acomoda App</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <style>
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
    }
    html, body {
      height: 100%;
    }
    body {
      background: radial-gradient(circle at top, #e5f0ff 0, #f4f6fb 45%, #edf0ff 100%);
      color: #111827;
      display: flex;
      justify-content: center;
      align-items: stretch;
    }
    .app-shell {
      max-width: 480px;
      width: 100%;
      margin: 8px;
      background: rgba(255, 255, 255, 0.96);
      border-radius: 24px;
      box-shadow: 0 12px 30px rgba(15,23,42,0.2);
      display: flex;
      flex-direction: column;
      overflow: hidden;
    }
    header {
      padding: 16px 16px 10px;
      background: linear-gradient(90deg, #1b4b82, #2563eb);
      color: white;
      text-align: center;
    }
    header h1 {
      font-size: 18px;
      font-weight: 700;
      letter-spacing: 0.05em;
    }
    header small {
      display: block;
      margin-top: 2px;
      font-size: 12px;
      opacity: 0.9;
    }
    main {
      flex: 1;
      padding: 12px;
      overflow-y: auto;
    }
    .card {
      background: white;
      border-radius: 18px;
      padding: 12px 12px 10px;
      margin-bottom: 10px;
      box-shadow: 0 2px 8px rgba(15,23,42,0.08);
    }
    .card-header {
      font-weight: 600;
      font-size: 15px;
      margin-bottom: 6px;
      display: flex;
      align-items: center;
      gap: 6px;
    }
    .card-header .pill {
      font-size: 11px;
      padding: 2px 8px;
      border-radius: 999px;
      background: #e0edff;
      color: #1d4ed8;
    }
    label {
      font-size: 13px;
      font-weight: 500;
      margin-bottom: 2px;
    }
    input[type="text"],
    input[type="password"],
    select {
      width: 100%;
      border-radius: 10px;
      border: 1px solid #d1d5db;
      padding: 7px 9px;
      font-size: 14px;
      background: #f9fafb;
    }
    input:focus, select:focus {
      outline: none;
      border-color: #2563eb;
      box-shadow: 0 0 0 1px rgba(37,99,235,0.4);
      background: #ffffff;
    }
    button {
      border: none;
      border-radius: 999px;
      padding: 8px 16px;
      font-size: 14px;
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      gap: 6px;
      background: #1b4b82;
      color: white;
      margin-top: 6px;
    }
    button.secondary {
      background: #e5e7eb;
      color: #111827;
    }
    button.danger {
      background: #b91c1c;
      color: white;
    }
    button:active {
      transform: scale(0.97);
    }
    .field-group {
      margin-bottom: 8px;
      display: flex;
      flex-direction: column;
    }
    .status {
      font-size: 12px;
      color: #4b5563;
      margin-top: 4px;
    }
    .login-section, .app-section {
      display: none;
    }
    .login-section.active, .app-section.active {
      display: block;
    }
    .pill-role-coord {
      background: #fef3c7;
      color: #92400e;
    }
    .pill-role-aco {
      background: #dcfce7;
      color: #166534;
    }
    .badge-user {
      display: inline-block;
      padding: 2px 8px;
      border-radius: 999px;
      font-size: 11px;
      background: #fef3c7;
      color: #92400e;
    }
  </style>
</head>
<body>
  <div class="app-shell">
    <header>
      <h1>ACOMODA APP</h1>
      <small>Control de asignaciones</small>
    </header>
    <main>
      <!-- LOGIN -->
      <section id="login-section" class="login-section active">
        <div class="card">
          <div class="card-header">
            Ingreso
            <span class="pill pill-role-coord">Coordinador</span>
            <span class="pill pill-role-aco">Acomodador</span>
          </div>
          <div class="field-group">
            <label for="rol-select">Rol</label>
            <select id="rol-select">
              <option value="coordinador">Coordinador</option>
              <option value="acomodador">Acomodador</option>
            </select>
          </div>
          <div class="field-group">
            <label for="pin-input">PIN</label>
            <input type="password" id="pin-input" placeholder="Ingrese PIN" />
            <div class="status" id="login-status"></div>
            <div class="status" style="font-size:11px;">
              El PIN del coordinador es privado. Los PIN de acomodadores se cargan en la sección de acomodadores.
            </div>
          </div>
          <button id="btn-login">Entrar</button>
        </div>
      </section>

      <!-- APP -->
      <section id="app-section" class="app-section">
        <div class="card">
          <div class="card-header">
            Sesión
            <span id="sesion-rol-pill" class="pill"></span>
          </div>
          <div id="sesion-detalle" class="status"></div>
          <button id="btn-logout" class="secondary" style="margin-top:6px;">Cerrar sesión</button>
        </div>

        <!-- Vista coordinador -->
        <section id="vista-coordinador" style="display:none;">
          <div class="card">
            <div class="card-header">
              Acomodadores
              <span class="pill">Listado y PIN</span>
            </div>
            <div class="field-group">
              <label for="ac-nombre">Nombre</label>
              <input type="text" id="ac-nombre" placeholder="Ej: Juan Pérez" />
            </div>
            <div class="field-group">
              <label for="ac-pin">PIN (para que ingrese a su cuenta)</label>
              <input type="password" id="ac-pin" placeholder="Ej: 1234" />
            </div>
            <button id="btn-agregar-acomodador">Agregar acomodador</button>
            <div id="estado-acomodadores" class="status"></div>
          </div>

          <div class="card">
            <div class="card-header">Listado actual</div>
            <div id="lista-acomodadores" class="status">Sin acomodadores cargados.</div>
          </div>
        </section>

        <!-- Vista acomodador -->
        <section id="vista-acomodador" style="display:none;">
          <div class="card">
            <div class="card-header">
              Mis asignaciones
              <span class="pill">Vista básica</span>
            </div>
            <div id="info-acom" class="status">
              Por ahora esta versión solo muestra el ingreso correcto. Más adelante sumamos el programa.
            </div>
          </div>
        </section>
      </section>
    </main>
  </div>

  <script>
    // utilidades
    function guardarLS(clave, valor) {
      localStorage.setItem(clave, JSON.stringify(valor));
    }
    function leerLS(clave, defecto) {
      const raw = localStorage.getItem(clave);
      if (!raw) return defecto;
      try { return JSON.parse(raw); } catch (e) { return defecto; }
    }

    // estado
    let acomodadores = leerLS("acomoda_acomodadores", []);
    let sesionActual = null;

    // elementos login
    const loginSection = document.getElementById("login-section");
    const appSection   = document.getElementById("app-section");
    const rolSelect    = document.getElementById("rol-select");
    const pinInput     = document.getElementById("pin-input");
    const loginBtn     = document.getElementById("btn-login");
    const loginStatus  = document.getElementById("login-status");

    // elementos sesión
    const sesionRolPill = document.getElementById("sesion-rol-pill");
    const sesionDetalle = document.getElementById("sesion-detalle");
    const btnLogout     = document.getElementById("btn-logout");

    // vistas
    const vistaCoord = document.getElementById("vista-coordinador");
    const vistaAcom  = document.getElementById("vista-acomodador");

    // acomodadores
    const acNombreInput = document.getElementById("ac-nombre");
    const acPinInput    = document.getElementById("ac-pin");
    const btnAgregarAc  = document.getElementById("btn-agregar-acomodador");
    const estadoAcs     = document.getElementById("estado-acomodadores");
    const listaAcsDiv   = document.getElementById("lista-acomodadores");

    function actualizarVistaSesion() {
      if (!sesionActual) {
        loginSection.classList.add("active");
        appSection.classList.remove("active");
        vistaCoord.style.display = "none";
        vistaAcom.style.display = "none";
        return;
      }
      loginSection.classList.remove("active");
      appSection.classList.add("active");

      if (sesionActual.rol === "coordinador") {
        vistaCoord.style.display = "block";
        vistaAcom.style.display = "none";
        sesionRolPill.textContent = "Coordinador";
        sesionRolPill.className = "pill pill-role-coord";
        sesionDetalle.textContent = "Ingreso como coordinador (PIN privado).";
      } else {
        vistaCoord.style.display = "none";
        vistaAcom.style.display = "block";
        sesionRolPill.textContent = "Acomodador";
        sesionRolPill.className = "pill pill-role-aco";
        sesionDetalle.textContent = "Ingreso como acomodador: " + sesionActual.nombre;
      }
    }

    loginBtn.addEventListener("click", () => {
      const rol = rolSelect.value;
      const pin = (pinInput.value || "").trim();
      loginStatus.textContent = "";

      if (!pin) {
        loginStatus.textContent = "Ingresá el PIN.";
        return;
      }

      if (rol === "coordinador") {
        if (pin === "999") {
          sesionActual = { rol: "coordinador" };
          pinInput.value = "";
          actualizarVistaSesion();
        } else {
          loginStatus.textContent = "PIN de coordinador incorrecto.";
        }
      } else {
        const ac = acomodadores.find(a => a.pin === pin);
        if (!ac) {
          loginStatus.textContent = "PIN de acomodador no encontrado.";
          return;
        }
        sesionActual = { rol: "acomodador", id: ac.id, nombre: ac.nombre };
        pinInput.value = "";
        actualizarVistaSesion();
      }
    });

    btnLogout.addEventListener("click", () => {
      sesionActual = null;
      actualizarVistaSesion();
    });

    function renderAcomodadores() {
      if (!acomodadores.length) {
        listaAcsDiv.textContent = "Sin acomodadores cargados.";
        return;
      }
      const frag = document.createDocumentFragment();
      acomodadores.forEach(ac => {
        const fila = document.createElement("div");
        fila.style.display = "flex";
        fila.style.justifyContent = "space-between";
        fila.style.alignItems = "center";
        fila.style.padding = "4px 0";
        fila.style.borderBottom = "1px solid #e5e7eb";

        const txt = document.createElement("div");
        txt.style.fontSize = "13px";
        txt.innerHTML = `<strong>${ac.nombre}</strong> <span class="badge-user">PIN: ${ac.pin}</span>`;

        const btnDel = document.createElement("button");
        btnDel.textContent = "Quitar";
        btnDel.className = "danger";
        btnDel.style.fontSize = "11px";
        btnDel.style.padding = "3px 8px";
        btnDel.addEventListener("click", () => {
          acomodadores = acomodadores.filter(a => a.id !== ac.id);
          guardarLS("acomoda_acomodadores", acomodadores);
          renderAcomodadores();
        });

        fila.appendChild(txt);
        fila.appendChild(btnDel);
        frag.appendChild(fila);
      });
      listaAcsDiv.innerHTML = "";
      listaAcsDiv.appendChild(frag);
    }

    btnAgregarAc.addEventListener("click", () => {
      const nombre = (acNombreInput.value || "").trim();
      const pin    = (acPinInput.value || "").trim();

      if (!nombre || !pin) {
        estadoAcs.textContent = "Completá nombre y PIN.";
        return;
      }
      if (acomodadores.some(a => a.pin === pin)) {
        estadoAcs.textContent = "Ya existe un acomodador con ese PIN.";
        return;
      }

      const nuevo = { id: Date.now().toString(), nombre, pin };
      acomodadores.push(nuevo);
      guardarLS("acomoda_acomodadores", acomodadores);
      acNombreInput.value = "";
      acPinInput.value = "";
      estadoAcs.textContent = "Acomodador agregado.";
      renderAcomodadores();
    });

    // init
    function init() {
      renderAcomodadores();
      actualizarVistaSesion();
    }
    init();
  </script>
</body>
</html>
